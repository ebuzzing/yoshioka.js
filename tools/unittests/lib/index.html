<!DOCTYPE html>
<html>
    <head>
        <title>Unit tests</title>
        <meta charset="utf-8"/>
        <script src="/config/tconfig.js"></script>
        <script type="text/javascript" charset="utf-8" src="{$yuipath}/yui/yui-min.js"></script>
        <script type="text/javascript" charset="utf-8" src="/yoshioka.js/tools/unittests/lib/unittests.view.js"></script>
        {$testssrc}
        <style type="text/css" media="screen">
            .running {
                background: lightblue;
            }
            .passed .ctn {
                background: green;
            }
            .passed .details {
                display: none;
            }
            .failed .ctn {
                background: red;
            }
            .ignored .ctn {
                background: gray;
            }

            .pass {
                background: green;
            }
            .fail {
                background: red;
            }
            .ignore {
                background: gray;
            }
        </style>
    </head>
    <body class="yui3-skin-sam">
        <script type="text/javascript" charset="utf-8">
        //<![CDATA[
            YUI().use("json", "io", "node", "ys/core", "test", "ys/views/unittests", {$testsmodules}, function(Y) {

                var view = new Y.ys.UnittestsView();
                Y.one('body').append(view.render());



                Y.Test.Runner.on(
                    'complete',
                    function(e)
                    {
                        return;
                        var b = Y.one(document.body),
                            n = Y.Node.create(
'<div class="results"><div class="resume"></div><div class="close">Close</div></div>'
                            ),
                            resume = Y.Node.create(
'<p>'+e.results.passed+" tests passed</p>"+
'<p>'+e.results.ignored+" tests ignored</p>"+
'<p>'+e.results.failed+" tests failed</p>"+
'<p>in '+e.results.duration+" ms</p>"
                            );

                        n.on(
                            'click',
                            function(e)
                            {
                                e.preventDefault();
                                this.hide();
                            },
                            n
                        );

                        if (e.results.failed > 0)
                        {
                            n.addClass('failed');
                        }
                        n.one('.resume').append(resume);

                        b.append(n);

                        // Sending results to server
                        Y.io(
                            '/__unittests/report/',
                            {
                                method: 'post',
                                data: Y.JSON.stringify(e.results)
                            }
                        );
                    }
                );

                //Y.Test.Runner.run();
            });
        //]]>
        </script>
    </body>
</html>
